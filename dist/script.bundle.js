!function(t){var e={};function s(a){if(e[a])return e[a].exports;var i=e[a]={i:a,l:!1,exports:{}};return t[a].call(i.exports,i,i.exports,s),i.l=!0,i.exports}s.m=t,s.c=e,s.d=function(t,e,a){s.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:a})},s.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=0)}([function(t,e,s){"use strict";s.r(e);class a{addTask(t){}getAllTask(){}updateTask(t,e){}removeTask(t){}markTaskComplete(t){}}class i extends a{constructor(){super(),this.key="taskToDo",localStorage[this.key]=localStorage[this.key]?localStorage[this.key]:JSON.stringify([])}addTask(t){var e=JSON.parse(localStorage[this.key]);e.push(t),localStorage[this.key]=JSON.stringify(e)}getAllTask(){return localStorage[this.key]?JSON.parse(localStorage[this.key]):new Error("Key Not Available")}updateTask(t,e){var s=JSON.parse(localStorage[this.key]),a=s.findIndex(e=>e.id==t);if(-1==a)return new Error("Not a valid id");s[a].task=e,localStorage[this.key]=JSON.stringify(s)}removeTask(t){var e=JSON.parse(localStorage[this.key]),s=e.findIndex(e=>e.id==t);if(-1==s)return new Error("Not a valid id");e.splice(s,1),localStorage[this.key]=JSON.stringify(e)}markTaskComplete(t){var e=JSON.parse(localStorage[this.key]),s=e.findIndex(e=>e.id==t);if(console.log(s),-1==s)return new Error("Not a valid id");e[s].isDone=!e[s].isDone,localStorage[this.key]=JSON.stringify(e)}}class r extends a{constructor(){super(),this.url="http://localhost:3000/",this.xhttp=new XMLHttpRequest,this.key="taskToDo"}get(t){var e=this;return this.xhttp.onreadystatechange=function(){4==this.readyState&&200==this.status&&(e=JSON.parse(this.responseText))},this.xhttp.open("GET",this.url+t,!1),this.xhttp.send(),e}post(t,e){this.xhttp.open("POST",this.url+t,!1),this.xhttp.setRequestHeader("Content-type","application/json"),this.xhttp.send(JSON.stringify(e))}put(t,e,s){this.xhttp.open("PUT",this.url+t+"/"+s,!1),this.xhttp.setRequestHeader("Content-type","application/json"),this.xhttp.send(JSON.stringify(e))}delete(t,e){this.xhttp.open("DELETE",this.url+t+"/"+e,!1),this.xhttp.send()}addTask(t){this.post(this.key,t)}getAllTask(){return this.get(this.key)}removeTask(t){this.delete(this.key,t)}updateTask(t,e){var s=this.get(this.key+"/"+t);s.task=e,this.put(this.key,s,s.id)}markTaskComplete(t){var e=this.get(this.key+"/"+t);e.isDone=!e.isDone,this.put(this.key,e,e.id)}}var n=class{static makeDatabase(t){switch(t){case"JSDB":return new r;case"LocalStorage":return new i}}}.makeDatabase("JSDB"),o={getAllTasks:()=>n.getAllTask(),addTask:t=>{n.addTask({task:t,isDone:!1,id:o.getId()})},changeTask:(t,e)=>{n.updateTask(t,e)},removeTask:t=>{n.removeTask(t)},markTaskComplete:t=>{n.markTaskComplete(t)},removeCompletedTask:()=>{n.getAllTask().forEach(t=>t.isDone&&n.removeTask(t.id))},getCurrentState:()=>n.getCurrentState(),setCurrentState:t=>{n.setCurrentState(t)},getId:()=>{return n.getAllTask().reduce((t,{id:e})=>Math.max(t,e),-1)+1}},l=o,d={init:function(){this.jtoDo=document.querySelector(".todo"),this.jinput=this.jtoDo.querySelector(".todo__taketask"),this.jinput.addEventListener("keydown",this.handleTaskAdd),this.jfilter_items=this.jtoDo.querySelectorAll(".filter__item"),this.jfilter_items.forEach(t=>t.addEventListener("click",this.handleActiveTab)),this.jtasks=this.jtoDo.querySelector(".tasklist"),this.jtasks.addEventListener("click",this.handleToggle),this.jtasks.addEventListener("dblclick",this.enableEditMode),this.jtasks.addEventListener("keydown",this.disableEditMode),this.jspan=this.jtoDo.querySelector(".clearcompleted"),this.jspan.addEventListener("click",this.handleClearCompletedButton),this.currentState="All",this.render()},handleTaskAdd:function(t){if("Enter"!=t.key)return;const e=this.value;""!=e&&(l.addTask(e),this.value="",d.render())},handleActiveTab:function(){d.currentState=this.textContent,d.jfilter_items.forEach(t=>t.classList.remove("filter__item--dark")),this.classList.add("filter__item--dark"),d.render()},handleToggle:function(t){t.target.matches(".tasklist--done")?d.markTaskComplete(t):t.target.matches(".tasklist--remove")&&d.removeTask(t)},markTaskComplete:function(t){const e=parseInt(t.target.dataset.index);l.markTaskComplete(e),d.render()},removeTask:function(t){const e=parseInt(t.target.dataset.index);l.removeTask(e),d.render()},render:function(){const t=d.currentState;console.log(t);const e=l.getAllTasks().filter(e=>!("Active"==t&&e.isDone||"Completed"==t&&!e.isDone)).map(t=>{const e=t.isDone?"tasklist__text tasklist__text--checked":"tasklist__text";return`\n                    <li class="tasklist__task">\n                        <span class="tasklist__item tasklist--done" data-index="${t.id}">&#10004</span>\n                        <span class="${e}" for="${t.id}"  data-index="${t.id}">${t.task}</span>  \n                        <span class="tasklist__item tasklist--remove" data-index="${t.id}">X</span>\n                    </li>`}).join("");this.jtasks.innerHTML=e,this.renderClearCompletesButton()},renderClearCompletesButton:function(){l.getAllTasks().some(t=>t.isDone)?this.jspan.classList.remove("clearcompleted--hide"):this.jspan.classList.add("clearcompleted--hide")},handleClearCompletedButton:function(){l.removeCompletedTask(),d.render()},enableEditMode:function(t){t.target.matches("span")&&(t.target.classList.add("tasklist__text--dark"),t.target.contentEditable=!0)},disableEditMode:function(t){if(!t.target.matches("span")||"Enter"!=t.key)return;t.target.contentEditable=!1;const e=parseInt(t.target.dataset.index),s=t.target.textContent;l.changeTask(e,s),console.log("x"),d.render()}};d.init()}]);